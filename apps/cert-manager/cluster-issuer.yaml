apiVersion: cert-manager.io/v1
kind: ClusterIssuer
metadata:
  name: letsencrypt-prod
spec:
  acme:
    server: https://acme-v02.api.letsencrypt.org/directory
    email: homelab@timosur.com
    privateKeySecretRef:
      name: letsencrypt-prod
    solvers:
      # argo.timosur.com
      - selector:
          dnsNames: ["argo.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: argo-acme-http
      # mealie.timosur.com
      - selector:
          dnsNames: ["mealie.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: mealie-acme-http
      # ai.timosur.com
      - selector:
          dnsNames: ["ai.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: ai-acme-http
      # automate.timosur.com
      - selector:
          dnsNames: ["automate.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: automate-acme-http
      # garden.timosur.com
      - selector:
          dnsNames: ["garden.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: garden-acme-http
      # zipline.timosur.com
      - selector:
          dnsNames: ["zipline.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: zipline-acme-http
      # file.timosur.com
      - selector:
          dnsNames: ["file.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: seafile-acme-http
      # timosur.com
      - selector:
          dnsNames: ["timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: portfolio-acme-http
      # givgroov.de
      - selector:
          dnsNames: ["givgroov.de"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: givgroov-acme-http
      # grafana.timosur.com
      - selector:
          dnsNames: ["grafana.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: grafana-acme-http
      # pangolin.timosur.com
      - selector:
          dnsNames: ["pangolin.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: pangolin-acme-http
      # finance.timosur.com
      - selector:
          dnsNames: ["finance.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: actual-acme-http
      # pinchflat.timosur.com
      - selector:
          dnsNames: ["pinchflat.timosur.com"]
        http01:
          gatewayHTTPRoute:
            parentRefs:
              - group: gateway.networking.k8s.io
                kind: Gateway
                name: main-gateway
                namespace: cert-manager
                sectionName: pinchflat-acme-http
