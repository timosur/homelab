apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
  - https://raw.githubusercontent.com/SynologyOpenSource/synology-csi/v1.2.1/deploy/kubernetes/v1.20/namespace.yml
  - https://raw.githubusercontent.com/SynologyOpenSource/synology-csi/v1.2.1/deploy/kubernetes/v1.20/csi-driver.yml
  - https://raw.githubusercontent.com/SynologyOpenSource/synology-csi/v1.2.1/deploy/kubernetes/v1.20/storage-class.yml
  - https://raw.githubusercontent.com/SynologyOpenSource/synology-csi/v1.2.1/deploy/kubernetes/v1.20/controller.yml
  - https://raw.githubusercontent.com/SynologyOpenSource/synology-csi/v1.2.1/deploy/kubernetes/v1.20/node.yml
  - external-secret.yaml
  - smb-credentials-secret.yaml
  - storage-class-smb.yaml

# Install in the synology-csi namespace
namespace: synology-csi

# Add pod security labels to the namespace
patches:
  - target:
      kind: Namespace
      name: synology-csi
    path: namespace-patch.yaml
  - target:
      kind: StorageClass
      name: storage-box-smb
    patch: |-
      - op: replace
        path: /parameters/dsm
        value: "192.168.1.100"  # Replace with your actual Synology IP
