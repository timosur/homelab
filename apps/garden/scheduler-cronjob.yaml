apiVersion: batch/v1
kind: CronJob
metadata:
  name: garden-scheduler
  namespace: garden
spec:
  schedule: "0 1 * * *"  # Run daily at 1 AM
  timeZone: "Europe/Berlin"
  jobTemplate:
    spec:
      template:
        spec:
          nodeSelector:
            workload-type: arm
          containers:
          - name: scheduler
            image: curlimages/curl:latest
            command:
            - /bin/sh
            - -c
            - |
              echo "Running garden watering schedule at $(date)"
              curl -X POST http://garden-backend:8000/api/garden/water
              echo "Garden watering request completed"
          restartPolicy: OnFailure
      backoffLimit: 3
